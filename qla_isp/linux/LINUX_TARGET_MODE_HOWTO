$Id: LINUX_TARGET_MODE_HOWTO,v 1.17 2006/06/29 21:14:54 mjacob Exp $
Copyright (c) 1997-2006 by Matthew Jacob
All rights reserved.


   Target Mode usage instructions (for 2.4.X)

A. Build for target mode enabled, use the target 'tgt', as in:

	make tgt

Static compilation into the kernel isn't supported.

B. Install scsi_tgt.o && isp_mod.o into the appropriate places, e.g.:


For 2.4.X:
	cp isp_mod.o /lib/modules/RELEASE/kernel/drivers/scsi
	cp scsi_target.o /lib/modules/RELEASE/kernel/drivers/scsi

where RELEASE is the full kernel release number you build against.

C. Type 'depmod -a'. Type 'modprobe isp_mod' to load both isp_mod and the
scsi_tgt module.  Usually the loader will pull in scsi_tgt.o as needed,
but you can alwyas do 'modprobe scsi_tgt' by itself first.

You can also add 'isp_debug=0xXXXX' to turn on debugging for target
mode- See ispvar.h for good values to try- but 0xe0f is a good healthy
amount to try.

If you load scsi_tgt.o first, you can add 'scsi_tdebug=1' to the
load line as well.

This now leaves you with isp loaded, and registered with scsi_target, but
with no LUNs enabled.

D. Do

scsi_target_ctl enable ispN channel target lun

where 'N' is the unit you want to enable a lun on (lun 0 must be first),
channel the port number (this really applies only to dual bus
SCSI cards), target (which is ignored) and lun.

Use disable to disable a lun. Lun 0 must be last out as it was
first in.

E. Things missing

The discerning amongst you will note that scsi_target is incomplete
at best. That is by design- it's up to *you* to write interesting
replacements for it.
