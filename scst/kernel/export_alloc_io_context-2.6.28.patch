diff -upkr linux-2.6.28/block/blk-ioc.c linux-2.6.28/block/blk-ioc.c
--- linux-2.6.28/block/blk-ioc.c	2008-10-10 02:13:53.000000000 +0400
+++ linux-2.6.28/block/blk-ioc.c	2008-11-25 21:27:01.000000000 +0300
@@ -105,6 +105,7 @@ struct io_context *alloc_io_context(gfp_
 
 	return ret;
 }
+EXPORT_SYMBOL(alloc_io_context);
 
 /*
  * If the current task has no IO context then create one and initialise it.
diff -upkr linux-2.6.28/include/linux/iocontext.h linux-2.6.28/include/linux/iocontext.h
--- linux-2.6.28/include/linux/iocontext.h	2008-10-10 02:13:53.000000000 +0400
+++ linux-2.6.28/include/linux/iocontext.h	2008-11-26 13:23:03.000000000 +0300
@@ -103,6 +103,7 @@ static inline struct io_context *ioc_tas
 int put_io_context(struct io_context *ioc);
 void exit_io_context(void);
 struct io_context *get_io_context(gfp_t gfp_flags, int node);
+#define SCST_ALLOC_IO_CONTEXT_EXPORTED
 struct io_context *alloc_io_context(gfp_t gfp_flags, int node);
 void copy_io_context(struct io_context **pdst, struct io_context **psrc);
 #else
